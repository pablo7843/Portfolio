---
const trabajos = [
    {
        title: 'Star WikiWars',
        description: 'Star Wars Wiki for fans',
        image: '/star-wars.webp',
        technologies: ['Kotlin'],
        details: 'Aplicaci贸n nativa de Android que utiliza la arquitectura MVVM. Desarrollada en Kotlin, consume la API p煤blica de Star Wars (SWAPI) para mostrar datos de personajes y naves, con una alta optimizaci贸n para la experiencia m贸vil.'
    },
    {
        title: 'Qr-Shield',
        description: 'Secure QR code scanner',
        image: '/banco.webp',
        technologies: ['Flutter', 'Supabase'],
        details: 'Escaner de QR seguro para prevenir phishing. Escanea c贸digos QR y verifica URLs para decidir si el c贸digo QR es seguro, sospechoso o peligroso. El usuario puede iniciar sesi贸n para activar el historial de escaneos y gestionarlos.'
    },
    {
        title: 'Music web reproducer',
        description: 'Reproducer online',
        image: '/harmoniq.png',
        technologies: ['React', 'Supabase'],
        details: 'Plataforma de streaming de m煤sica construida con React para el frontend y Supabase (backend como servicio) para la autenticaci贸n y almacenamiento. Focalizada en la gesti贸n de sesiones seguras y reproducci贸n optimizada.'
    }
];

const getTechIcon = (tech: string) => {
    const name = tech.toLowerCase().replace(/\s+/g, '');
    return `https://cdn.jsdelivr.net/gh/devicons/devicon/icons/${name}/${name}-original.svg`;
};

const getTechColor = (tech: string) => {
    const colors: Record<string, string> = {
        'react': '#2784F5',
        'kotlin': '#7F52FF',
        'supabase': '#3ECF8E',
        'flutter': '#02569B'
    };
    return colors[tech.toLowerCase().replace(/\s+/g, '')] || '#cccccc';
};
---

<div class="trabajos-wrapper-outer">
    <h2 class="glitch-text">PROJECT_ARCHIVES</h2>
    
    <div class="trabajos-container">
        {trabajos.map((trabajo, index) => (
            <div class="flip-card" data-aos="fade-up">
                <div class="flip-card-inner" id={`card-inner-${index}`}>
                    
                    <div class="flip-card-front">
                        <div class="image-header">
                            <img src={trabajo.image} alt={trabajo.title} class="imagen-trabajo" />
                        </div>
                        <div class="card-body">
                            <h3>{trabajo.title}</h3>
                            <p class="descripcion">{trabajo.description}</p>
                            <div class="tecnologias">
                                {trabajo.technologies.map(tech => (
                                    <span class="tech-badge" style={`border: 1px solid ${getTechColor(tech)}; background: ${getTechColor(tech)}22`}>
                                        <img src={getTechIcon(tech)} alt={tech} class="tech-icon" />
                                        <span class="tech-name" style={`color: ${getTechColor(tech)}`}>{tech}</span>
                                    </span>
                                ))}
                            </div>
                            <button class="flip-btn" onclick={`document.getElementById('card-inner-${index}').classList.add('is-flipped')`}>
                                ACCESS_DETAILS
                            </button>
                        </div>
                    </div>

                    <div class="flip-card-back">
                        <div class="details-content">
                            <h4 class="details-title">FILE_SPECIFICATIONS</h4>
                            <div class="scroll-area">
                                <p class="details-text">{trabajo.details}</p>
                            </div>
                            <div class="action-links">
                                <a href="#" target="_blank">CODE_LINK </a>
                                <a href="#" target="_blank">LIVE_DEMO </a>
                            </div>
                            <button class="back-btn" onclick={`document.getElementById('card-inner-${index}').classList.remove('is-flipped')`}>
                                GO_BACK
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        ))}
    </div>
</div>

<style>
    /* --- CONTENEDOR PRINCIPAL --- */
    .trabajos-wrapper-outer {
        max-width: 1200px;
        margin: 80px auto;
        padding: 0 20px;
        font-family: 'Courier New', monospace;
    }

    .glitch-text {
        font-size: 2.5rem;
        font-weight: bold;
        letter-spacing: 7px;
        color: var(--text-primary);
        text-shadow: 0 0 10px var(--primary-color);
        text-align: center;
        padding-bottom: 25px;
    }

    /* --- GRID SISTEMA --- */
    .trabajos-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr); 
        gap: 2.5rem;
        perspective: 2000px; /* Intensidad del efecto 3D */
    }

    /* --- LGICA DE GIRO (FLIP) --- */
    .flip-card {
        background-color: transparent;
        height: 520px;
        width: 100%;
    }

    .flip-card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
        transform-style: preserve-3d;
    }

    .is-flipped {
        transform: rotateY(180deg);
    }

    .flip-card-front, .flip-card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
        border-radius: 4px;
        border: 1px solid rgba(0, 255, 0, 0.2);
        display: flex;
        flex-direction: column;
        overflow: hidden;
    }

    /* --- ESTILOS CARA FRONTAL --- */
    .flip-card-front {
        background-color: var(--bg-dark-light);
    }

    .image-header {
        height: 200px;
        overflow: hidden;
        border-bottom: 1px solid rgba(0, 255, 0, 0.1);
    }

    .imagen-trabajo {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: 0.5s;
    }

    .card-body {
        padding: 1.5rem;
        display: flex;
        flex-direction: column;
        flex-grow: 1;
    }

    .card-body h3 { color: #fff; font-size: 1.4rem; margin: 0 0 0.5rem 0; }
    .descripcion { color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1.5rem; }

    .tecnologias { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem; }
    .tech-badge { padding: 4px 10px; border-radius: 2px; display: flex; align-items: center; gap: 6px; font-size: 0.75rem; }
    .tech-icon { width: 14px; height: 14px; }

    /* --- ESTILOS CARA TRASERA --- */
    .flip-card-back {
        background-color: #080808;
        transform: rotateY(180deg);
        padding: 1.5rem;
        border-color: var(--primary-color);
    }

    .details-content {
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .details-title {
        color: var(--primary-color);
        font-size: 1rem;
        margin-bottom: 1rem;
        border-bottom: 1px solid rgba(0, 255, 0, 0.2);
        padding-bottom: 5px;
    }

    .scroll-area {
        flex-grow: 1;
        overflow-y: auto;
        padding-right: 5px;
    }

    /* Scrollbar minimalista */
    .scroll-area::-webkit-scrollbar { width: 4px; }
    .scroll-area::-webkit-scrollbar-thumb { background: var(--primary-color); border-radius: 10px; }

    .details-text { font-size: 0.85rem; line-height: 1.6; color: #ddd; }

    .action-links {
        display: flex;
        justify-content: space-between;
        margin: 1.5rem 0;
    }

    .action-links a {
        color: var(--primary-color);
        text-decoration: none;
        font-size: 0.8rem;
        font-weight: bold;
    }

    /* --- BOTONES --- */
    .flip-btn, .back-btn {
        width: 100%;
        padding: 12px;
        cursor: pointer;
        font-family: inherit;
        font-weight: bold;
        transition: 0.3s;
        background: transparent;
    }

    .flip-btn {
        border: 1px solid var(--primary-color);
        color: var(--primary-color);
        margin-top: auto;
    }

    .flip-btn:hover { background: var(--primary-color); color: #000; }

    .back-btn {
        border: 1px solid #ff4444;
        color: #ff4444;
    }

    .back-btn:hover { background: #ff4444; color: #fff; }

    /* --- MODO CLARO --- */
    html.light-mode .flip-card-front { background: #ffffff; border-color: #ddd; }
    html.light-mode .flip-card-front h3 { color: #222; }
    html.light-mode .flip-card-back { background: #f5f5f5; border-color: #ccc; }
    html.light-mode .details-text { color: #444; }

    /* --- RESPONSIVE (CELULAR Y TABLET) --- */
    @media (max-width: 1024px) {
        .trabajos-container { grid-template-columns: repeat(2, 1fr); }
    }

    @media (max-width: 768px) {
        .trabajos-wrapper-outer { margin: 40px auto; }
        
        .glitch-text { font-size: 1.8rem; margin-bottom: 2.5rem; }

        .trabajos-container { 
            grid-template-columns: 1fr; /* Una tarjeta debajo de otra */
            gap: 2rem;
        }

        .flip-card {
            height: 480px; /* Altura optimizada para m贸viles */
        }
    }
</style>