---
const trabajos = [
    {
        title: 'Star WikiWars',
        description: 'Star Wars Wiki for fans',
        image: '/star-wars.webp',
        technologies: ['Kotlin'],
        details: 'Aplicaci贸n nativa de Android que utiliza la arquitectura MVVM. Desarrollada en Kotlin, consume la API p煤blica de Star Wars (SWAPI) para mostrar datos de personajes y naves, con una alta optimizaci贸n para la experiencia m贸vil.'
    },
    {
        title: 'Qr-Shield',
        description: 'Secure QR code scanner',
        image: '/banco.webp',
        technologies: ['Flutter', 'Supabase'],
        details: 'Escaner de QR seguro para prevenir phishing. Escanea c贸digos QR y verifica URLs para decidir si el c贸digo QR es seguro, sospechoso o peligroso. El usuario puede iniciar sesi贸n para activar el historial de escaneos y gestionarlos.'
    },
    {
        title: 'Music web reproducer',
        description: 'Reproducer online',
        image: '/harmoniq.png',
        technologies: ['React', 'Supabase'],
        details: 'Plataforma de streaming de m煤sica construida con React para el frontend y Supabase (backend como servicio) para la autenticaci贸n y almacenamiento. Focalizada en la gesti贸n de sesiones seguras y reproducci贸n optimizada.'
    }
];

const getTechIcon = (tech: string) => {
    const name = tech.toLowerCase().replace(/\s+/g, '');
    return `https://cdn.jsdelivr.net/gh/devicons/devicon/icons/${name}/${name}-original.svg`;
};

const getTechColor = (tech: string) => {
    const colors: Record<string, string> = {
        'react': '#2784F5',
        'kotlin': '#7F52FF',
        'supabase': '#3ECF8E',
        'flutter': '#02569B'
    };
    return colors[tech.toLowerCase().replace(/\s+/g, '')] || '#cccccc';
};
---

<div class="trabajos-wrapper-outer">
    <h2 class="glitch-text">PROJECT_ARCHIVES</h2>
    
    <div class="trabajos-container">
        {trabajos.map((trabajo, index) => (
            <div class="flip-card" data-aos="fade-up">
                <div class="flip-card-inner" id={`card-inner-${index}`}>
                    
                    <div class="flip-card-front">
                        <div class="image-header">
                            <img src={trabajo.image} alt={trabajo.title} class="imagen-trabajo" />
                        </div>
                        <div class="card-body">
                            <h3>{trabajo.title}</h3>
                            <p class="descripcion">{trabajo.description}</p>
                            <div class="tecnologias">
                                {trabajo.technologies.map(tech => (
                                    <span class="tech-badge" style={`border: 1px solid ${getTechColor(tech)}; background: ${getTechColor(tech)}22`}>
                                        <img src={getTechIcon(tech)} alt={tech} class="tech-icon" />
                                        <span class="tech-name" style={`color: ${getTechColor(tech)}`}>{tech}</span>
                                    </span>
                                ))}
                            </div>
                            <button class="flip-btn" onclick={`document.getElementById('card-inner-${index}').classList.add('is-flipped')`}>
                                ACCESS_DETAILS
                            </button>
                        </div>
                    </div>

                    <div class="flip-card-back">
                        <div class="details-content">
                            <h4 class="details-title">FILE_SPECIFICATIONS</h4>
                            <p>{trabajo.details}</p>
                            <div class="action-links">
                                <a href="#" target="_blank">CODE_LINK </a>
                                <a href="#" target="_blank">LIVE_DEMO </a>
                            </div>
                            <button class="back-btn" onclick={`document.getElementById('card-inner-${index}').classList.remove('is-flipped')`}>
                                GO_BACK
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        ))}
    </div>
</div>

<style>
    .trabajos-wrapper-outer {
        max-width: 1400px;
        margin: 80px auto;
        padding: 0 20px;
        font-family: 'Courier New', monospace;
    }

    .glitch-text {
        font-size: 2.5rem;
        text-align: center;
        margin-bottom: 3rem;
        color: var(--primary-color);
        letter-spacing: 5px;
    }

    .trabajos-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr); 
        gap: 2.5rem;
        perspective: 1000px; /* Necesario para el efecto 3D */
    }

    /* Estructura de la Carta */
    .flip-card {
        background-color: transparent;
        height: 480px;
        perspective: 1000px;
    }

    .flip-card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        text-align: left;
        transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        transform-style: preserve-3d;
    }

    .is-flipped {
        transform: rotateY(180deg);
    }

    .flip-card-front, .flip-card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
        border-radius: 4px;
        border: 1px solid rgba(0, 255, 0, 0.2);
        overflow: hidden;
        display: flex;
        flex-direction: column;
    }

    .flip-card-front {
        background-color: var(--bg-dark-light);
    }

    .flip-card-back {
        background-color: #0a0a0a;
        color: white;
        transform: rotateY(180deg);
        border-color: var(--primary-color);
        padding: 2rem;
        justify-content: center;
    }

    /* Estilos Front */
    .image-header { height: 200px; overflow: hidden; }
    .imagen-trabajo { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
    .card-body { padding: 1.5rem; flex-grow: 1; display: flex; flex-direction: column; }
    .card-body h3 { color: #fff; margin-bottom: 0.5rem; }
    .descripcion { color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem; }
    
    .tecnologias { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1.5rem; }
    .tech-badge { padding: 4px 12px; border-radius: 2px; display: flex; align-items: center; gap: 8px; font-size: 0.75rem; }
    .tech-icon { width: 14px; height: 14px; }

    /* Botones de Acci贸n */
    .flip-btn, .back-btn {
        margin-top: auto;
        padding: 10px;
        border: 1px solid var(--primary-color);
        background: transparent;
        color: var(--primary-color);
        cursor: pointer;
        font-family: inherit;
        font-weight: bold;
        transition: 0.3s;
    }

    .flip-btn:hover { background: var(--primary-color); color: #000; }
    .back-btn { border-color: var(--secondary-color); color: var(--secondary-color); margin-top: 20px; }
    .back-btn:hover { background: var(--secondary-color); color: #000; }

    /* Estilos Back */
    .details-title { color: var(--primary-color); margin-bottom: 1rem; border-bottom: 1px solid; width: fit-content; }
    .details-content p { font-size: 0.9rem; line-height: 1.6; color: #ccc; }
    .action-links { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; }
    .action-links a { color: var(--primary-color); text-decoration: none; font-weight: bold; font-size: 0.85rem; }
    .action-links a:hover { text-decoration: underline; }

    /* MODO CLARO */
    html.light-mode .flip-card-front { background: #fff; border-color: #ddd; }
    html.light-mode .flip-card-front h3 { color: #222; }
    html.light-mode .flip-card-back { background: #f4f4f4; color: #222; }
</style>